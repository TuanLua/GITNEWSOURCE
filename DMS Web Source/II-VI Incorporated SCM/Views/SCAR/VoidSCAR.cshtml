@model II_VI_Incorporated_SCM.Models.SCAR.SupplierCompletedViewModel

@{
    ViewBag.Title = "SCAR";
}

<button type="button" class="btn btn-success" onclick="backToIndex()">Close</button>

<div align="center"><h2><strong>SUPPLIER CORRECTIVE ACTION REQUEST (SCAR)</strong></h2></div>
<div>
    <table class="table table-striped table-bordered table-hover" border="1">
        <tr>
            <td colspan="10">
                &nbsp;
            </td>
            <td colspan="4">Form: 005-0206 Rev </td>
        </tr>
        <tr>
            <td colspan="5">
                <div class="row top-buffer">
                    <label class="col-md-2 control-label">Supplier:</label>
                    <div class="col-md-10">
                        @Html.TextBox("VEN_NAM", (string)ViewBag.SupplierInfo.VEN_NAM, new { @class = "form-control", @readonly = "readonly" })
                    </div>
                </div>

                <div class="row top-buffer">
                    <label class="col-md-2 control-label">Address:</label>
                    <div class="col-md-10">
                        @Html.TextBox("ADDRESS", (string)ViewBag.SupplierInfo.ADDRESS, new { @class = "form-control", @readonly = "readonly" })
                    </div>
                </div>

                <div class="row top-buffer">
                    <label class="col-md-2 control-label">Contact:</label>
                    <div class="col-md-10">
                        @Html.TextBox("CONTACT", (string)ViewBag.SupplierInfo.CONTACT, new { @class = "form-control", @readonly = "readonly" })
                    </div>
                </div>

                <div class="row top-buffer">
                    <label class="col-md-2 control-label">Email:</label>
                    <div class="col-md-10">
                        @Html.TextBox("EMAIL", (string)ViewBag.SupplierInfo.EMAIL, new { @class = "form-control", @readonly = "readonly" })
                    </div>
                </div>

                <div class="row top-buffer">
                    <label class="col-md-2 control-label">Tel:</label>
                    <div class="col-md-10">
                        @Html.TextBox("TEL", (string)ViewBag.SupplierInfo.TEL, new { @class = "form-control", @readonly = "readonly" })
                    </div>
                </div>

                <div class="row top-buffer">
                    <label class="col-md-2 control-label">Fax:</label>
                    <div class="col-md-10">
                        @Html.TextBox("FAX", (string)ViewBag.SupplierInfo.FAX, new { @class = "form-control", @readonly = "readonly" })
                    </div>
                </div>
            </td>
            <td colspan="3">
                <div class="row top-buffer">
                    <label class="col-md-4 control-label">SCAR #:</label>
                    <div class="col-md-8">
                        @Html.TextBox("SCAR_ID", Model.SCARInfo.SCAR_ID, new { @class = "form-control", @readonly = "readonly" })
                    </div>
                </div>

                <div class="row top-buffer">
                    <label class="col-md-4 control-label">Noncomforming Qty:</label>
                    <div class="col-md-8">
                        @Html.TextBox("NON_QTY", Model.SCARInfo.NON_QTY, new { @class = "form-control", @readonly = "readonly" })
                        <span id="Err_NonConfQty" class="help-block text-danger"></span>
                    </div>
                </div>

                <div class="row top-buffer">
                    <label class="col-md-4 control-label">II-VI Marlow NCR #:</label>
                    <div class="col-md-8">
                        @Html.TextBox("NCR_NUMBER", Model.SCARInfo.NCR_NUMBER, new { @class = "form-control digital-led", @readonly = "readonly" })
                    </div>
                </div>

                <div class="row top-buffer">
                    <label class="col-md-4 control-label">RMA#:</label>
                    <div class="col-md-8">
                        @Html.TextBox("RMA", Model.SCARInfo.RMA, new { @class = "form-control", @readonly = "readonly" })
                        <span id="Err_RMA" class="help-block text-danger"></span>
                    </div>
                </div>
            </td>
            <td colspan="4">
                <div class="row top-buffer">
                    <label class="col-md-5 control-label">Requested By:</label>
                    <div class="col-md-7">
                    </div>
                </div>

                <div class="row top-buffer">
                    <label class="col-md-3 control-label">Buyer:</label>
                    <div class="col-md-9">
                        @Html.TextBox("BUYER", Model.SCARInfo.BUYER, new { @class = "form-control", @readonly = "readonly" })
                    </div>
                </div>

                <div class="row top-buffer">
                    <label class="col-md-3 control-label">Quality:</label>
                    <div class="col-md-9">
                        @Html.TextBox("QUALITY", Model.SCARInfo.QUALITY, new { @class = "form-control", @readonly = "readonly" })
                    </div>
                </div>

                <div class="row top-buffer">
                    <div class="col-md-12">
                        <table class="table table-striped table-bordered table-hover">
                            <tr style="background-color:gray">
                                <td colspan="2" align="center">
                                    For II-VI Marlow Use Only:
                                </td>
                            </tr>
                            <tr style="background-color:gray">
                                <td>
                                    VN SCAR #:
                                </td>
                                <td>@Html.TextBox("VN_SCAR", Model.SCARInfo.VN_SCAR, new { @class = "form-control", @readonly = "readonly" })</td>
                            </tr>
                            <tr style="background-color:gray">
                                <td>
                                    VN NCR #:
                                </td>
                                <td>@Html.TextBox("VN_NCR", Model.SCARInfo.VN_NCR, new { @class = "form-control", @readonly = "readonly" })</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </td>
        </tr>
        <tr>
            <td colspan="12">
                Purchase Order Number:	@Html.TextBox("PO_NUMBER", Model.SCARInfo.PO_NUMBER, new { @class = "form-control", @readonly = "readonly" })
            </td>
        </tr>
        <tr>
            <td colspan="12">
                II-VI Marlow Part Number: @Html.TextBox("MI_PART_NO", Model.SCARInfo.MI_PART_NO, new { @class = "form-control", @readonly = "readonly" })
            </td>
        </tr>
        <tr>
            <td colspan="8"><b>CUSTOMER CONCERN:</b></td>
            <td colspan="2">DATE</td>
            <td colspan="2">
                @String.Format("{0:MM-dd-yyyy}", Model.SCARInfo.DATEPROBLEM)
            </td>
        </tr>
        <tr>
            <td colspan="12">
                Recurring Problem?
                @Html.TextBox("RECURING_PROBLEM", Model.SCARInfo.RECURING_PROBLEM, new { @readonly = "readonly" })
            </td>
        </tr>
        <tr>
            <td colspan="12">
                @Html.TextArea("PROBLEM", Model.SCARInfo.PROBLEM, new { @class = "form-control", @rows = 5, @readonly = "readonly" })
            </td>
        </tr>
        <tr>
            <td colspan="12">
                The above material was found to be non-compliant with the II-VI Marlow specification or purchase order.  Please identify the cause of the defect and the corrective and preventive action taken.  A response should be returned by the given date (below).  Should you require additional time, please contact the II-VI Marlow Supplier Quality Department prior to the due date to request an extension.  (Attach objective evidence as proof of actions taken.)

            </td>

        </tr>
        <tr>
            <td colspan="4">
                Please Respond By:
            </td>
            <td colspan="4">@Html.TextBox("DATERESPOND", String.Format("{0:MM/dd/yyyy}", Model.SCARInfo.DATERESPOND), new { @class = "form-control", @readonly = "readonly", @style = "background-color:yellow" })</td>
            <td colspan="4"></td>
        </tr>
        <tr>
            @if (Model.D0.EDIVENCE != ".." && Model.D0.EDIVENCE != "" && Model.D0.EDIVENCE != null)
            {
                <td colspan="6"><strong><b>D0 - PLAN</b></strong></td>
                <td colspan="2"><a target="_blank" href="@Model.D0.EDIVENCE"><i class='fa'>Edivence</i></a></td>
            }
            else
            {
                <td colspan="8"><strong><b>D0 - PLAN</b></strong></td>
            }
            <td colspan="2">DATE</td>
            <td colspan="2">@String.Format("{0:MM-dd-yyyy}", Model.D0.DATE_D0)</td>
        </tr>
        <tr>
            <td colspan="12">
                @Model.D0.CONTENT
            </td>
        </tr>
        <tr>
            <td colspan="12"></td>
        </tr>
        <tr>
            @if (Model.D1.EDIVENCE != ".." && Model.D1.EDIVENCE != "" && Model.D1.EDIVENCE != null)
            {
                <td colspan="6"><strong><b>D1 - USE TEAM APPROACH</b></strong></td>
                <td colspan="2"><a target="_blank" href="@Model.D1.EDIVENCE"><i class='fa'>Edivence</i></a></td>
            }
            else
            {
                <td colspan="8"><strong><b>D1 - USE TEAM APPROACH</b></strong></td>
            }
            <td colspan="2">DATE</td>
            <td colspan="2">@String.Format("{0:MM-dd-yyyy}", Model.D1.DATE_D1)</td>
        </tr>
        <tr>
            <td colspan="4">
                Team Leader:
            </td>
            <td colspan="2">
                Champion:
            </td>
            <td colspan="2">
                Member:
            </td>
            <td colspan="6">
                External member:
            </td>
        </tr>
        <tr style="color:blue">
            <td colspan="4">
                @Model.D1.LEADER
            </td>
            <td colspan="2">
                @Model.D1.CHAMPION
            </td>
            <td colspan="2">
                @Model.D1.MEMBER
            </td>
            <td colspan="6">
                @Model.D1.EXTERNAL_MEMBER
            </td>
        </tr>
        <tr>
            <td colspan="12"></td>
        </tr>
        <tr>
            @if (Model.D2.EDIVENCE != ".." && Model.D2.EDIVENCE != "" && Model.D2.EDIVENCE != null)
            {
                <td colspan="6"><strong><b>D2 - DESCRIBE THE PROBLEM</b></strong></td>
                <td colspan="2"><a target="_blank" href="@Model.D2.EDIVENCE"><i class='fa'>Edivence</i></a></td>
            }
            else
            {
                <td colspan="8"><strong><b>D2 - DESCRIBE THE PROBLEM</b></strong></td>
            }
            <td colspan="2">DATE</td>
            <td colspan="2">@String.Format("{0:MM-dd-yyyy}", Model.D2.DATE_D2)</td>
        </tr>
        <tr style="color:blue">
            <td colspan="12">
                @Model.D2.CONTENT
            </td>
        </tr>
        <tr>
            <td colspan="12"></td>
        </tr>
        <tr>
            @if (Model.D3.Count > 0)
            {
                if (Model.D3[0].EDIVENCE != ".." && Model.D3[0].EDIVENCE != "" && Model.D3[0].EDIVENCE != null)
                {
                    <td colspan="6"><strong><b>D3 - IMPLEMENT CONTAINMENT PLANS (SHORT TERM) - DESCRIBE</b></strong></td>
                    <td colspan="2"><a target="_blank" href="@Model.D3[0].EDIVENCE"><i class='fa'>Edivence</i></a></td>
                }
                else
                {
                    <td colspan="8"><strong><b>D3 - IMPLEMENT CONTAINMENT PLANS (SHORT TERM) - DESCRIBE</b></strong></td>
                }
            }
            else
            {
                <td colspan="8"><strong><b>D3 - IMPLEMENT CONTAINMENT PLANS (SHORT TERM) - DESCRIBE</b></strong></td>
            }
            <td colspan="2">WHO</td>
            <td colspan="2">WHEN</td>
        </tr>
        @foreach (var item in Model.D3)
        {
            <tr style="color:blue">
                <td colspan="8">@item.CONTENT</td>
                <td colspan="2">@item.WHO_IMPLEMENT</td>
                <td colspan="2">@String.Format("{0:MM-dd-yyyy}", item.WHEN_IMPLEMENT)</td>
            </tr>
        }
        <tr>
            <td colspan="12"></td>
        </tr>
        <tr>
            @if (Model.D4.EDIVENCE != ".." && Model.D4.EDIVENCE != "" && Model.D4.EDIVENCE != null)
            {
                <td colspan="6"><strong><b>D4 - DESCRIBE THE ROOT CAUSE</b></strong></td>
                <td colspan="2"><a target="_blank" href="@Model.D4.EDIVENCE"><i class='fa'>Edivence</i></a></td>
            }
            else
            {
                <td colspan="8"><strong><b>D4 - DESCRIBE THE ROOT CAUSE</b></strong></td>
            }
            <td colspan="2">DATE</td>
            <td colspan="2">@String.Format("{0:MM-dd-yyyy}", Model.D4.DATE_D4)</td>
        </tr>
        <tr style="color:blue">
            <td colspan="12">
                @Model.D4.CONTENT
            </td>
        </tr>
        <tr>
            <td colspan="12"></td>
        </tr>
        <tr>
            @if (Model.D5.Count > 0)
            {
                if (Model.D5[0].EDIVENCE != ".." && Model.D5[0].EDIVENCE != "" && Model.D5[0].EDIVENCE != null)
                {
                    <td colspan="6"><strong><b>D5 - IMPLEMENT PERMANENT CORRECTIVE ACTIONS - DESCRIBE</b></strong></td>
                    <td colspan="2"><a target="_blank" href="@Model.D5[0].EDIVENCE"><i class='fa'>Edivence</i></a></td>
                }
                else
                {
                    <td colspan="8"><strong><b>D5 - IMPLEMENT PERMANENT CORRECTIVE ACTIONS - DESCRIBE</b></strong></td>
                }
            }
            else
            {
                <td colspan="8"><strong><b>D5 - IMPLEMENT PERMANENT CORRECTIVE ACTIONS - DESCRIBE</b></strong></td>
            }
            <td colspan="2">WHO</td>
            <td colspan="2">WHEN</td>
        </tr>
        @foreach (var item in Model.D5)
        {
            <tr style="color:blue">
                <td colspan="8">@item.CONTENT</td>
                <td colspan="2">@item.WHO_IMPLEMENT</td>
                <td colspan="2">@String.Format("{0:MM-dd-yyyy}", item.WHEN_IMPLEMENT)</td>
            </tr>
        }
        <tr>
            <td colspan="12"></td>
        </tr>
        <tr>
            @if (Model.D6.Count > 0)
            {
                if (Model.D6[0].EDIVENCE != ".." && Model.D6[0].EDIVENCE != "" && Model.D6[0].EDIVENCE != null)
                {
                    <td colspan="6"><strong><b>D6 - VALIDATION OF CORRECTIVE ACTION (Please attach copies of audits, meeting minutes, or other type of activities that can be reviewed.)</b></strong></td>
                    <td colspan="2"><a target="_blank" href="@Model.D6[0].EDIVENCE"><i class='fa'>Edivence</i></a></td>
                }
                else
                {
                    <td colspan="8"><strong><b>D6 - VALIDATION OF CORRECTIVE ACTION (Please attach copies of audits, meeting minutes, or other type of activities that can be reviewed.)</b></strong></td>
                }
            }
            else
            {
                <td colspan="8"><strong><b>D6 - VALIDATION OF CORRECTIVE ACTION (Please attach copies of audits, meeting minutes, or other type of activities that can be reviewed.)</b></strong></td>
            }
            <td colspan="2">WHO</td>
            <td colspan="2">WHEN</td>
        </tr>
        @foreach (var item in Model.D6)
        {
            <tr style="color:blue">
                <td colspan="8">@item.CONTENT</td>
                <td colspan="2">@item.WHO_IMPLEMENT</td>
                <td colspan="2">@String.Format("{0:MM-dd-yyyy}", item.WHEN_IMPLEMENT)</td>
            </tr>
        }
        <tr>
            <td colspan="12"></td>
        </tr>
        <tr>
            @if (Model.D7.Count > 0)
            {
                if (Model.D7[0].EDIVENCE != ".." && Model.D7[0].EDIVENCE != "" && Model.D7[0].EDIVENCE != null)
                {
                    <td colspan="6"><strong><b>D7 - VERIFY EFFECTIVENESS - DESCRIBE</b></strong></td>
                    <td colspan="2"><a target="_blank" href="@Model.D7[0].EDIVENCE"><i class='fa'>Edivence</i></a></td>
                }
                else
                {
                    <td colspan="8"><strong><b>D7 - VERIFY EFFECTIVENESS - DESCRIBE</b></strong></td>
                }
            }
            else
            {
                <td colspan="8"><strong><b>D7 - VERIFY EFFECTIVENESS - DESCRIBE</b></strong></td>
            }
            <td colspan="2">WHO</td>
            <td colspan="2">WHEN</td>
        </tr>
        @foreach (var item in Model.D7)
        {
            <tr style="color:blue">
                <td colspan="8">@item.CONTENT</td>
                <td colspan="2">@item.WHO_IMPLEMENT</td>
                <td colspan="2">@String.Format("{0:MM-dd-yyyy}", item.WHEN_IMPLEMENT)</td>
            </tr>
        }
        <tr>
            <td colspan="12"></td>
        </tr>
        <tr>
            @if (ViewBag.FileD8 != "")
            {
                <td colspan="6"><strong><b>D8 - Verification</b></strong></td>
                <td colspan="6">
                    <a onclick="DownloadFile('@ViewBag.FileD8')"><i class='fa fa-file-pdf-o'></i> @ViewBag.FileD8</a>
                </td>
            }
            else
            {
                <td colspan="12"><strong><b>D8 - Verification</b></strong></td>
            }
        </tr>
        <tr>
            <td colspan="12">
                @Html.TextArea("CONTENTD8", Model.SCARInfo.CONTENT, new { @class = "form-control", @rows = 5, @style = "color:blue", @readonly = "readonly" })
            </td>
        </tr>
        <tr>
            <td colspan="12"></td>
        </tr>
        <tr>
            <td colspan="4">Supplier Representative:</td>
            <td colspan="4">Response Date:</td>
            <td colspan="4">II-VI Marlow acknowledgement:</td>
        </tr>
        <tr>
            <td colspan="4">@Html.TextBox("SUPPLIER_REPRESENTATIVE", Model.SCARInfo.SUPPLIER_REPRESENTATIVE, new { @class = "form-control", @style = "color:blue", @readonly = "readonly" })</td>
            <td colspan="4">@Html.TextBox("DATE_D8", Model.SCARInfo.DATE_D8.Value.ToString("MM/dd/yyyy"), new { @class = "form-control", @style = "color:blue", @readonly = "readonly" })</td>
            <td colspan="4">@Html.TextBox("ACKNOWLEDGEMENT", Model.SCARInfo.ACKNOWLEDGEMENT, new { @class = "form-control", @style = "color:blue", @readonly = "readonly" })</td>
        </tr>
        <tr>
            <td colspan="12"></td>
        </tr>
        <tr>
            <td colspan="8"></td>
            <td colspan="2">SCAR status:</td>
            <td colspan="2">@Html.TextBox("SCAR_STATUS", Model.SCARInfo.STATUS, new { @class = "form-control", @style = "color:blue", @readonly = "readonly" })</td>
        </tr>
    </table>
</div>
<script>
    function backToIndex() {
        window.location = '@Url.Action("Index", "SCAR")';
    }

    function DownloadFile(fileName) {
        $.blockUI();
        var id = '@Model.SCARInfo.ID';
      //  location.href = "Url.Action("DownloadFileD8", "SCAR", new { SCARID = Model.SCARInfo.SCAR_ID, fileName_ = fileName })";
        location.href = "@Url.Action("DownloadFileD8", "SCAR")?SCARID=" + id + "&fileName=" + fileName;
        $.unblockUI();
    }
</script>